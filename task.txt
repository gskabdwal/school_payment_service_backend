Objective
Develop a microservice for a School Payment and Dashboard Application. The focus of this assessment is to create a REST API
for managing Transactions and Payments.

ğŸ› ï¸ Project Setup
1. Initialize Project
â— Use Node.js with NestJS (or a similar framework like Express, Fastify, etc.)
â— Connect the application to MongoDB Atlas

ğŸ—ƒï¸ Database Schemas
Use MongoDB atlas for DB URI
I. Order Schema
Stores order-related information.

Fields types
_id Object_id
school_id Object_id /string
trustee_id Object_id /string
student_info {
name:string,
id:string,
email:string
}
gateway_name String

II. Order Status Schema
Stores payment transaction information.

Fields types
collect_id ObjectId (Reference to Order schema (_id))
order_amount number
transaction_amount number
payment_mode string
payment_details string
bank_reference string
payment_message string
status string
error_message string
payment_time Date and time

III. Webhook Logs Schema
Custom schema to store webhook-related logs.

ğŸ” User Authentication (JWT)
â— Create a User Schema to store login credentials.
â— Secure all API endpoints using JWT Authentication.

TASKS
ğŸ” Payment Gateway Integration
API Documentation:

Refer to this document:
ğŸ“„ Payment API Docs
Integration Flow:
â— Implement a POST /create-payment route.
â— Accept payment details from the user.
â— Forward data to the payment API using create-collect-request
â— Generate JWT-signed payloads as required.
â— Redirect the user to the payment page from the API response.
â— hint: read document carefully and implement create-collect-request/ create transaction and
redirect user to payment page(link will be in response of API) , use jsonwebtoken of sign
Credentials for Payment API
ï‚· pg_key : edvtest01
ï‚· API KEY :
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0cnVzdGVlSWQiOiI2NWIwZTU1MmRkMzE5NTBhOWI
0MWM1YmEiLCJJbmRleE9mQXBpS2V5Ijo2LCJpYXQiOjE3MTE2MjIyNzAsImV4cCI6MTc0MzE3OTg
3MH0.Rye77Dp59GGxwCmwWekJHRj6edXWJnff9finjMhxKuw
ï‚· school_id : 65b0e6293e9f76a9694d84b4

ğŸŒ Webhook Integration
Create a POST route to update transactions details in DB with the given payload
Endpoint:
POST /webhook
Payload Format:
{
"status": 200,
"order_info": {
"order_id": "collect_id/transaction_id",

"order_amount": 2000,
"transaction_amount": 2200,
"gateway": "PhonePe",
"bank_reference": "YESBNK222",
"status": "success",
"payment_mode": "upi",
"payemnt_details": "success@ybl",
"Payment_message": "payment success",
"payment_time": "2025-04-23T08:14:21.945+00:00",
"error_message": "NA"
}

Actions:
â— Parse the webhook payload.
â— Update the corresponding Order Status entry in MongoDB.

Tip: Use Postman to simulate webhook calls.

ğŸ“„ API Endpoints
1. Fetch All Transactions
â— GET /transactions
â— Use MongoDB aggregation pipeline to combine order and order_status schemas.

â— Fields to return:
â—‹ collect_id
â—‹ school_id
â—‹ gateway
â—‹ order_amount
â—‹ transaction_amount
â—‹ status
â—‹ custom_order_id

Note: Populate dummy data in both schemas for testing.
this API will return data by combining to schemas order and order status use mongodb
pipeline to join these two schemas

2. Fetch Transactions by School
â— GET /transactions/school/:schoolId
â— Returns all transactions related to a specific school.

3. Check Transaction Status
â— GET /transaction-status/:custom_order_id
â— Returns the current status of the transaction.

âœ… Additional Notes
â— Data Validation & Error Handling
Ensure proper validation of all incoming data using validation libraries (e.g., class-validator for

NestJS). Implement consistent and informative error responses across all endpoints.
â— Environment Configuration
Use .env files and the ConfigModule in NestJS (or similar) to manage environment variables.
This includes sensitive keys like:
â—‹ MongoDB Atlas connection string
â—‹ Payment API credentials (API key, PG key)
â—‹ JWT secret and expiry time
â— README & Documentation
Include a comprehensive README.md file with:
â—‹ Setup and installation instructions
â—‹ API usage examples
â—‹ Environment variable configuration
â—‹ Postman collection for testing
â— Scalability & Performance
â—‹ Pagination: Implement pagination for all list endpoints (e.g., /transactions) using limit
and page query parameters.
â—‹ Sorting: Support sorting by fields such as payment_time, status, or transaction_amount
via query parameters (e.g., sort=payment_time&order=desc).
â—‹ Indexing: Ensure important fields like school_id, custom_order_id, and collect_id are
indexed in MongoDB to speed up queries.

â— Security Best Practices
â—‹ Use JWT Authentication for all protected routes.
â—‹ Sanitize and validate incoming requests to prevent injection attacks.
â—‹ Use HTTPS in production and set appropriate CORS policies.
â— Robust Logging

â—‹ Log incoming webhook events and failed transactions for audit and debugging.

Submission Guidelines
1. Hosting
o Host your project on a cloud platform (e.g., Heroku, AWS, or similar) to make it
accessible via a public URL.

2. GitHub Repository
o Push your code to a public GitHub repository.
o Include comprehensive API documentation in the repositoryâ€™s README file, explaining
how to use each endpoint.
o Provide env file
3. Submission Links
o Share the hosted project link along with the GitHub